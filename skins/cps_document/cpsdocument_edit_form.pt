<tal:block define="res python:here.editCPSDocument(REQUEST=request);
                   rendered_main python: res[0];
                   portal_status_message python: res[1];
                   edition python:1;
  ">
<metal:block define-macro="edit_form">
<metal:block use-macro="here/content_lib_master/macros/master">
  <metal:block fill-slot="css_slot">
    <link rel="Stylesheet" type="text/css" href=""
      tal:attributes="href string:${base_url}document.css" />

    <metal:block define-macro="widgets_javascript">
    <!-- XXX this has to move to CPSSchemas -->
    <style type="text/css"
      tal:content="string:@import url(${base_url}calendar-win2k-1.css);"></style>
    <script type="text/javascript" src="calendar.js"
      tal:attributes="src string:${base_url}calendar.js"></script>
    <script type="text/javascript" src="lang/calendar-en.js"
      tal:define="local cpsmcat/getSelectedLanguage"
      tal:attributes="src string:${base_url}lang/calendar-${local}.js"></script>
    <script type="text/javascript" src="calendar-setup.js"
      tal:attributes="src string:${base_url}calendar-setup.js"></script>

    <tal:block condition="python:modules['Products.CPSUtil.integration'].isProductPresent('Products.FCKeditor')">
      <script type="text/javascript">
        var popup_editor_form = 'popup_fckeditor_form';
        var width = 640;
        var height = 520;
      </script>
    </tal:block>
    <tal:block condition="python:not modules['Products.CPSUtil.integration'].isProductPresent('Products.FCKeditor')">
      <script type="text/javascript">
        var popup_editor_form = 'popup_rte_form';
        var width = 640;
        var height = 480;
      </script>
    </tal:block>
    <script type="text/javascript">
     function popup_rte(input_id, label_edit) {
       var args, value;
       value = document.getElementById(input_id).value;
       args = '?input_id='+input_id+'&amp;label_edit='+escape(label_edit);
       str_window_features = 'toolbar=0,scrollbars=0,location=0,statusbar=0,menubar=0,resizable=1,dependent=1,width=' + width + ',height=' + height;
       popup = window.open(popup_editor_form + args, input_id, str_window_features);
       if (!popup.opener) {
         popup.opener = window;
       }
       return false;
     }
   </script>
   </metal:block>
  </metal:block>

  <metal:block fill-slot="header"
    tal:define="creation creation|nothing;
                edition edition|nothing;
                metadata metadata|nothing">
    <h1 tal:condition="creation" i18n:translate="">
      Create a document of type
      <tal:block i18n:name="type_name" i18n:translate=""
            tal:define="type_name request/type_name;
                        type_info python:here.portal_types[type_name]"
            tal:content="type_info/Title">Type Title</tal:block>
    </h1>
    <h1 tal:condition="not:creation">
      <img tal:replace="structure python:here.getImgTag('/'+here.getIcon(), base_url='')">
      <tal:block condition="edition"
        i18n:translate="">Edit <span i18n:name="title"
        tal:content="here/title_or_id">Page Title</span></tal:block>
      <tal:block tal:condition="metadata"
        i18n:translate="">heading_metadata_edit</tal:block>
    </h1>
  </metal:block>

  <metal:block fill-slot="main">
    <div tal:replace="structure rendered_main" />
  </metal:block>

</metal:block>
</metal:block>
</tal:block>
